library(shiny)
library(dplyr)

shinyServer(
  function(input, output) {
   
    wine <- na.omit(read.csv("wine_reviews.csv")) #Read in data & remove NAs
        
    output$otype <- renderPrint({input$varietal})
    output$oregion <- renderPrint({input$region})
    output$oprice <- renderPrint({as.character(c(paste(input$price, collapse='-')))})
  
    output$avg_price <- renderText({
      avg_price <- round(mean(wine[wine$varietal == input$varietal & wine$region == input$region,'price']),2)
      
      paste("Average price of", input$varietal, "from", input$region, "$", avg_price)
    })
    output$table <- renderDataTable({ 
      filter <- subset(wine, varietal == input$varietal & region == input$region & price >= input$price[1] & price <= input$price[2])         
    })
    
   output$avg_pts <- renderText({
      avg_pts <- round(mean(wine[wine$varietal == input$varietal & wine$region == input$region & wine$price >= input$price[1] & wine$price <= input$price[2],'points']),0)
      
      paste("Average points of", input$varietal, "from", input$region, "within the price range of $", input$price[1], "-", input$price[2], "is", avg_pts)
  })  
  }
)